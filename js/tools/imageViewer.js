export default function imageViewer(){let n=!1,a=1,r=!1,s=!1,i=0,o=0,l=0,c=0,d=0;const t=document.querySelector(".image-viewer-container"),m=t.querySelector("img"),v=e=>{document.body.style.overflow=e?"hidden":"auto",e?t.classList.add("active"):t.classList.remove("active")};let u=0;var e=e=>{r&&e.stopPropagation(),r=!1,m.style.cursor="grab"};m.addEventListener("wheel",e=>{e.preventDefault();var t=m.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,n=n-t.width/2,r=r-t.height/2,t=a;a+=-.001*e.deltaY,t<(a=Math.min(Math.max(.8,a),4))?(c-=n*(a-t),d-=r*(a-t)):(c=0,d=0),m.style.transform=`translate(${c}px, ${d}px) scale(${a})`},{passive:!1}),m.addEventListener("mousedown",e=>{e.preventDefault(),r=!0,o=e.clientX,l=e.clientY,m.style.cursor="grabbing"},{passive:!1}),m.addEventListener("mousemove",e=>{var t,n;!r||(t=(new Date).getTime())-u<100||(u=t,t=e.clientX-o,n=e.clientY-l,c+=t,d+=n,o=e.clientX,l=e.clientY,m.style.transform=`translate(${c}px, ${d}px) scale(${a})`,s=!0)},{passive:!1}),m.addEventListener("mouseup",e,{passive:!1}),m.addEventListener("mouseleave",e,{passive:!1}),t.addEventListener("click",e=>{s||(n=!1,v(n),a=1,c=0,d=0,m.style.transform=`translate(${c}px, ${d}px) scale(${a})`),s=!1});const p=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img"),y=e=>{"Escape"===e.key&&n&&(n=!1,v(n),a=1,c=0,d=0,m.style.transform=`translate(${c}px, ${d}px) scale(${a})`,document.removeEventListener("keydown",y))};p.forEach((e,t)=>{e.addEventListener("click",()=>{i=t,n=!0,v(n),m.src=e.src,document.addEventListener("keydown",y)})});document.addEventListener("keydown",t=>{if(n){if("ArrowUp"===t.key||"ArrowLeft"===t.key)i=(i-1+p.length)%p.length;else{if("ArrowDown"!==t.key&&"ArrowRight"!==t.key)return;i=(i+1)%p.length}t=p[i];let e=t.src;t.hasAttribute("lazyload")&&(e=t.getAttribute("data-src"),t.src=e,t.removeAttribute("lazyload")),m.src=e}}),!p.length&&t&&t.parentNode.removeChild(t)}